# K-means Clustering: why?
problems with Hierarchical clustering:
- runtime
- k-means is fast in large dataset
# K-means Clustering: how?
1. Generate cluster centers
    1. `k-means(obs,kk_or_guess,iter,thresh,check_finite)`
    2. return tow values: `cluster centers` and `distortion`
2.  Generate cluster labels
    1. `vq(obs,code_book,check_finite)`
    1. code_book is clster center returned by the kmeans function
    3. return two variables `cluster_labels` and a `list of distortions`
# k-means clustering: first exercise:
We apply the two step dance:
```python
# Import the kmeans and vq functions
from scipy.cluster.vq import kmeans, vq

# Generate cluster centers
cluster_centers, distortion = kmeans(comic_con[['x_scaled','y_scaled']] ,2)

# Assign cluster labels
comic_con['cluster_labels'], distortion_list = vq(comic_con[['x_scaled','y_scaled']], cluster_centers)
```
Now, we draw and see:
``` py
# Plot clusters
sns.scatterplot(x='x_scaled', y='y_scaled', 
                hue='cluster_labels', data = comic_con)
plt.show()
```
![kmeans clustering](img/Figure%201.svg)

# Faster :)
Kmeans clustering is exponentially faster than hierarchical clustering.

# How many clusters?
we draw an elbow plot
## Drawing an elbow plot
The elbow plot generated by the below code is:
![elbow plot of our kmeans](img/Figure%202.svg)
```python 
distortions = []
num_clusters = range(1, 7)

# Create a list of distortions from the kmeans function
for i in num_clusters:
    cluster_centers, distortion = kmeans(comic_con[['x_scaled','y_scaled']],i)
    distortions.append(distortion)

# Create a DataFrame with two lists - num_clusters, distortions
elbow_plot = pd.DataFrame({'num_clusters': num_clusters, 'distortions': distortions})

# Creat a line plot of num_clusters and distortions
sns.lineplot(x='num_clusters', y='distortions', data = elbow_plot)
plt.xticks(num_clusters)
plt.show()
```
## How many clusters?
From the elbow plot, we see a sharp change in the "inclinaison" of the line at num_clusters of `2`.

## Uniform Distribution
let's draw an elbow plot for a uniform distribution

```python
distortions = []
num_clusters = range(2, 7)

# Create a list of distortions from the kmeans function
for i in num_clusters:
    cluster_centers, distortion = kmeans(uniform_data[['x_scaled', 'y_scaled']], i)
    distortions.append(distortion)

# Create a DataFrame with two lists - number of clusters and distortions
elbow_plot = pd.DataFrame({'num_clusters': num_clusters, 'distortions': distortions})

# Creat a line plot of num_clusters and distortions
sns.lineplot(x='num_clusters', y='distortions', data=elbow_plot)
plt.xticks(num_clusters)
plt.show()
```

    Elbow plot: 
![Elbow plot of a uniform distribution](img/Figure%203.svg)

the elbow is not well defined here. So we can't really choose.